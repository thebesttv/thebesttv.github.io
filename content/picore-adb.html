<!DOCTYPE html>
<html lang="zh-CN">
<head>
<!-- 2025-10-28 02:51 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>piCore ç¼–è¯‘ ADB å°è®°</title>
<meta name="author" content="thebesttv" />
<meta name="generator" content="Org Mode" />
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-21YM95T3BQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-21YM95T3BQ');
</script>
<!-- favicon -->
<link rel="icon" type="image/x-icon" href="../favicon.ico">
<!-- CSS -->
<link rel="stylesheet" type="text/css" href="https://unpkg.com/latex.css/style.css">
<link rel="stylesheet" type="text/css" href="../css/org-default.css">
<link rel="stylesheet" type="text/css" href="../css/style.css">
<!-- pagefind -->
<link rel="stylesheet" type="text/css" href="../_pagefind/pagefind-ui.css">
<script src="../_pagefind/pagefind-ui.js" type="text/javascript"></script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
      new PagefindUI({element: "#search", showImages: false, resetStyles: false});
  });
</script>
</head>
<body>
<div id="preamble" class="status">
<nav class="org-center">
<a href="../index.html">Home</a>
<div id="search"></div>
<hr>
</nav>
</div>
<div id="content" class="content">
<header>
<h1 class="title">piCore ç¼–è¯‘ ADB å°è®°</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orge96f291">1. çƒ§å½• piCore</a></li>
<li><a href="#org46bafc2">2. åŸºæœ¬é…ç½®</a></li>
<li><a href="#orgf457076">3. å„ç§ä¾èµ–</a>
<ul>
<li><a href="#orgea21eb7">3.1. protobuf</a></li>
<li><a href="#orge70a1f6">3.2. brotli</a></li>
<li><a href="#org844e790">3.3. GoogleTest</a></li>
<li><a href="#orgf53fea4">3.4. Go</a></li>
</ul>
</li>
<li><a href="#org1f513b1">4. ç¼–è¯‘ ADB</a></li>
<li><a href="#org8d10029">5. å†…ç½‘ç©¿é€</a></li>
<li><a href="#orgcc0f199">6. å°ç»“</a></li>
</ul>
</div>
</nav>
<hr style="width: 80%;">
<ul class="org-ul">
<li><a href="http://tinycorelinux.net/12.x/armv7/releases/RPi/README">12.X armv7 ç‰ˆæœ¬çš„ README</a> å’Œ <a href="http://tinycorelinux.net/12.x/armv7/releases/RPi/IMPORTANT">IMPORTANT</a>, ä»‹ç»äº† piCore çš„åŸºæœ¬ä¿¡æ¯,
ç™»å½•åæœ€åŸºæœ¬çš„é…ç½®, å¸å·å¯†ç ç­‰.  ä¸åŒç‰ˆæœ¬ä¹‹é—´çš„ä¸»è¦å†…å®¹å¤§å·®ä¸å·®~</li>
<li><a href="http://tinycorelinux.net/book.html">Core book</a> å€¼å¾—ä¸€çœ‹çš„ä¹¦, è®²çš„æ˜¯ Tiny Core çš„é…ç½®, ä¸è¿‡å¤§åŒå°å¼‚.
é‡ç‚¹çœ‹ä¸€ä¸‹å¦‚ä½•æ‰“åŒ… (extension).</li>
<li><a href="https://archlinux.org/packages/community/x86_64/android-tools/">ArchLinux package: android-tools</a>, ä¸Šæ¸¸çš„ repo è§ä¸‹, å¯ä»¥ç”¨æ¥ç¼–è¯‘ ADB</li>
<li><a href="https://github.com/nmeum/android-tools">android-tools</a>, åªè¦é…ç½®å¥½ä¾èµ–å°±èƒ½ç”¨è¿™ä¸ª repo ç®€å•åœ°ç¼–è¯‘ ADB äº†~
æ³¨æ„è¦å» release é¡µé¢ä¸‹è½½æºç , ä¸è¦ git clone recursive (ç™½èŠ±äº†4Gæµé‡&#x2026;)</li>
</ul>

<p>
åœ¨ 8G çš„æ ‘è“æ´¾ 4B ä¸Šè¿è¡Œ piCore å¹¶ä¸”ç¼–è¯‘ä¸€ä¸ª ADB.
ç¼–è¯‘å¥½ååœ¨æ ‘è“æ´¾ 3B ä¸Šè¿è¡Œ, ä¸”å¼€æœºå¯åŠ¨ frp.
åŒ…å«äº† piCore çš„æœ€åŸºæœ¬çš„é…ç½®æ–¹æ³•.
</p>

<p>
å¦‚æœç¼–è¯‘ä¸€ä¸ªåˆ ä¸€ä¸ª, è€Œä¸”æ¯ä¸ªéƒ½å•çº¿ç¨‹ç¼–è¯‘çš„è¯,
å¯èƒ½å¯ä»¥åœ¨æ ‘è“æ´¾3Bçš„1Gå†…å­˜ä¸‹ç›´æ¥ç¼–è¯‘, ä¸è¿‡æˆ‘ä¹Ÿæ²¡è¯•è¿‡~
ç„¶åäº¤å‰ç¼–è¯‘å•¥çš„å°±æ›´ä¸ä¼šäº†ğŸ˜µ
</p>
<div id="outline-container-orge96f291" class="outline-2">
<h2 id="orge96f291"><span class="section-number-2">1.</span> <a href="#orge96f291">çƒ§å½• piCore</a></h2>
<div class="outline-text-2" id="text-1">
<p>
Tiny Core ç›®å‰çš„ç‰ˆæœ¬æ˜¯ 13.X, åœ¨<a href="http://tinycorelinux.net/downloads.html">å®˜ç½‘çš„ä¸‹è½½é¡µé¢</a>åº•éƒ¨æœ‰å„ç§ç§»æ¤ç‰ˆçš„<a href="http://tinycorelinux.net/ports.html">ä¸‹è½½é¡µé¢</a>.
13.X ç‰ˆå„ç§æ¶æ„çš„ä¸‹è½½é¡µé¢åœ¨<a href="http://tinycorelinux.net/13.x/">è¿™é‡Œ</a>.  è¿™æ¬¡é€‰æ‹©çš„æ˜¯ armv7 æ¶æ„çš„ <a href="http://tinycorelinux.net/13.x/armv7/releases/RPi/piCore-13.1.0.zip"><code>piCore-13.1.0.zip</code></a>.
</p>

<p>
å°†å‹ç¼©åŒ…è§£å‹, å¾—åˆ° <code>piCore-13.1.0.img</code>.
ä½¿ç”¨ <code>lsblk</code> ç¡®å®š SD å¡ä¸ºè®¾å¤‡ <code>/dev/sdb</code>, ä½¿ç”¨ <code>dd</code> å†™å…¥.
(æ¯æ¬¡å†™çš„æ—¶å€™éƒ½è¦æ£€æŸ¥å¥½å‡ é, ç”Ÿæ€•è®¾å¤‡å†™æˆç¡¬ç›˜&#x2026;)
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo dd <span style="font-weight: bold; font-style: italic;">if</span>=piCore-13.1.0.img <span style="font-weight: bold; font-style: italic;">of</span>=/dev/sdb <span style="font-weight: bold; font-style: italic;">bs</span>=1M <span style="font-weight: bold; font-style: italic;">status</span>=progress
</pre>
</div>
<p>
å†™å®Œä¹Ÿå¯ä»¥ç”¨ <code>lsblk</code> æˆ–è€… <code>fdisk</code> æ£€æŸ¥ä¸€ä¸‹, å¯ä»¥çœ‹åˆ°ç°åœ¨æœ‰ä¸¤ä¸ªåˆ†åŒº,
ç¬¬äºŒä¸ª Linux çš„åªæœ‰ 16MB, éœ€è¦åœ¨å¼€æœºå expand ä¸€ä¸‹
</p>
<div class="org-src-container">
<pre class="src src-bash">$ sudo fdisk -l /dev/sdb
Disk /dev/sdb: 30 GiB, 32212254720 bytes, 62914560 sectors
Disk model: SD/MMC/MS PRO
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xe85b7916

Device     Boot  Start    End Sectors Size Id Type
/dev/sdb1         8192 139263  131072  64M  c W95 FAT32 (LBA)
/dev/sdb2       139264 172031   32768  16M 83 Linux
</pre>
</div>

<p>
æ ‘è“æ´¾éœ€è¦è¿æ¥ç½‘çº¿, ä¸Šç”µåå¯ä»¥ç›´æ¥ <code>ssh</code>, ç”¨æˆ·åä¸º <code>tc</code>, åˆå§‹å¯†ç ä¸º
<code>piCore</code>, ä¸èƒ½ä»¥ <code>root</code> ç™»å½•.  ç¬¬ä¸€æ¬¡å¼€æœºæ—¶, éœ€è¦ç”Ÿæˆ SSH key,
æ‰€ä»¥ä¼šæ¯”è¾ƒæ…¢.
</p>
</div>
</div>
<div id="outline-container-org46bafc2" class="outline-2">
<h2 id="org46bafc2"><span class="section-number-2">2.</span> <a href="#org46bafc2">åŸºæœ¬é…ç½®</a></h2>
<div class="outline-text-2" id="text-2">
<p>
ç™»å½•å, æœ‰ä¸¤ä¸ªæœ€é‡è¦çš„äº‹æƒ…
</p>
<ol class="org-ol">
<li><p>
å¤‡ä»½åˆšç”Ÿæˆçš„ SSH key (è¿˜æœ‰ <code>ssh-copy-id</code> å¯¼å…¥çš„å…¬é’¥ä¹‹ç±»çš„)
</p>
<div class="org-src-container">
<pre class="src src-bash">filetool.sh -b
</pre>
</div></li>
<li><p>
ç”¨ <code>fdisk</code> æ‰©å±•ä¹‹å‰åªæœ‰ 16MB çš„ SD å¡åˆ†åŒº.
ç”¨ <code>p</code> æŸ¥çœ‹å½“å‰åˆ†åŒº, è®°å½•ä¸‹ç¬¬äºŒä¸ªåˆ†åŒº (<code>/dev/mmcblk0p2</code>) çš„èµ·å§‹å—å· (StartLBA).
ç”¨ <code>d</code> åˆ é™¤ç¬¬äºŒä¸ªåˆ†åŒº, å†ç”¨ <code>n</code> æ–°å»ºåˆ†åŒº, èµ·å§‹å—å·ä¸ä¹‹å‰ç›¸åŒ, ç»“æŸå—å·åœ¨æœ€å.
æœ€åç”¨ <code>w</code> å†™å…¥åˆ†åŒºè¡¨.
</p>
<div class="org-src-container">
<pre class="src src-bash">$ sudo fdisk -u /dev/mmcblk0

The number of cylinders for this disk is set to 983040.
There is nothing wrong with that, but this is larger than 1024,
and could<span style="font-weight: bold;"> in</span> certain setups cause problems with:
1) software that runs at boot time (e.g., old versions of LILO)
2) booting and partitioning software from other OSs
   (e.g., DOS FDISK, OS/2 FDISK)

<span style="font-weight: bold;">Command</span> (m for help): p
Disk /dev/mmcblk0: 30 GB, 32212254720 bytes, 62914560 sectors
983040 cylinders, 4 heads, 16 sectors/track
Units: sectors of 1 * 512 = 512 bytes

Device       Boot StartCHS    EndCHS        StartLBA     EndLBA    Sectors  Size Id Type
/dev/mmcblk0p1    128,0,1     127,3,16          8192     139263     131072 64.0M  c Win95 FAT32 (LBA)
/dev/mmcblk0p2    128,0,1     639,3,16        139264     172031      32768 16.0M 83 Linux

<span style="font-weight: bold;">Command</span> (m for help): d
Partition number (1-4): 2

<span style="font-weight: bold;">Command</span> (m for help): n
Partition type
   p   primary partition (1-4)
   e   extended
p
Partition number (1-4): 2
First sector (16-62914559, default 16): 139264
Last sector or +size{,K,M,G,T} (139264-62914559, default 62914559):
Using default value 62914559

<span style="font-weight: bold;">Command</span> (m for help): p
Disk /dev/mmcblk0: 30 GB, 32212254720 bytes, 62914560 sectors
983040 cylinders, 4 heads, 16 sectors/track
Units: sectors of 1 * 512 = 512 bytes

Device       Boot StartCHS    EndCHS        StartLBA     EndLBA    Sectors  Size Id Type
/dev/mmcblk0p1    128,0,1     127,3,16          8192     139263     131072 64.0M  c Win95 FAT32 (LBA)
/dev/mmcblk0p2    1023,3,16   1023,3,16       139264   62914559   62775296 29.9G 83 Linux

<span style="font-weight: bold;">Command</span> (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table
fdisk: WARNING: rereading partition table failed, kernel still uses old table: Device or resource busy
</pre>
</div>
<p>
æ³¨æ„, å†™å…¥åä¼šæœ‰ä¸€ä¸ª warning, ä½†å¯ä»¥å¿½ç•¥.
</p>

<p>
æœ€å<b>é‡å¯æ ‘è“æ´¾</b>, resize åˆ†åŒºäºŒ
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo resize2fs /dev/mmcblk0p2
</pre>
</div></li>
</ol>

<p>
ç”±äºåŒ…çš„æºåœ¨å›½å¤–, å¯èƒ½ä¼šæ¯”è¾ƒæ…¢, å¯ä»¥ç”¨ä»£ç†
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="font-weight: bold;">export</span> <span style="font-weight: bold; font-style: italic;">http_proxy</span>=<span style="font-style: italic;">'http://192.168.1.123:8889'</span>
</pre>
</div>
<p>
å®‰è£…ä¸€äº›å¿…è¦çš„åŒ…
</p>
<div class="org-src-container">
<pre class="src src-bash">tce-load -wi bash vim openssh file htop git
</pre>
</div>
<p>
è¿™äº›æ˜¯ç¼–è¯‘éœ€è¦çš„&#x2014;<code>compiletc</code> åŒ…å«äº† <code>gcc</code>, <code>binutils</code>, <code>m4</code>, <code>make</code> ç­‰;
è¿˜éœ€è¦ <code>coreutils</code>, <code>cmake</code> ç­‰
</p>
<div class="org-src-container">
<pre class="src src-bash">tce-load -wi compiletc coreutils <span style="font-style: italic;">\</span>
         cmake autoconf automake perl5 <span style="font-style: italic;">\</span>
         squashfs-tools
</pre>
</div>

<p>
æŠŠ <code>tc</code> å’Œ <code>root</code> çš„ shell è®¾ç½®æˆ <code>bash</code>
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo sed -i <span style="font-style: italic;">'/root/s_/bin/sh_/bin/bash_'</span> /etc/passwd
sudo sed -i <span style="font-style: italic;">'/tc/s_/bin/sh_/bin/bash_'</span> /etc/passwd
</pre>
</div>

<p>
å¼„å¥½åéœ€è¦å¤‡ä»½ä¸€ä¸‹
</p>
<div class="org-src-container">
<pre class="src src-bash">filetool.sh -b
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf457076" class="outline-2">
<h2 id="orgf457076"><span class="section-number-2">3.</span> <a href="#orgf457076">å„ç§ä¾èµ–</a></h2>
<div class="outline-text-2" id="text-3">
<p>
å‡†å¤‡ ADB éœ€è¦çš„<a href="https://github.com/nmeum/android-tools#dependencies">ä¾èµ–</a>, æœ‰çš„å¯ä»¥ç”¨ <code>tce-load</code> ç›´æ¥ä¸‹è½½
</p>
<div class="org-src-container">
<pre class="src src-bash">tce-load -wi <span style="font-style: italic;">\</span>
         libtool libtool-dev <span style="font-style: italic;">\</span>
         zstd zstd-dev <span style="font-style: italic;">\</span>
         liblz4 liblz4-dev <span style="font-style: italic;">\</span>
         libusb libusb-dev <span style="font-style: italic;">\</span>
         pcre2 pcre2-dev
</pre>
</div>
<p>
å‰©ä¸‹çš„å°±è¦è‡ªå·±ç¼–è¯‘äº†.  æ‰€æœ‰ç¼–è¯‘å’Œå®‰è£…éƒ½åœ¨ <code>/tmp</code> ä¸‹è¿›è¡Œ.
</p>
</div>
<div id="outline-container-orgea21eb7" class="outline-3">
<h3 id="orgea21eb7"><span class="section-number-3">3.1.</span> <a href="#orgea21eb7">protobuf</a></h3>
<div class="outline-text-3" id="text-3-1">
<p>
å®‰è£…æ–¹æ³•è§ <a href="https://github.com/protocolbuffers/protobuf/blob/main/src/README.md">README</a>, ä¸‹è½½æºç  <a href="https://github.com/protocolbuffers/protobuf/releases/download/v21.4/protobuf-cpp-3.21.4.tar.gz"><code>protobuf-cpp-3.21.4.tar.gz</code></a> ç¼–è¯‘
(ps. <code>nproc</code> åœ¨åŒ… <code>coreutils</code> ä¸­)
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="font-weight: bold;">cd</span> /tmp
tar xf protobuf-cpp-3.21.4.tar.gz
<span style="font-weight: bold;">cd</span> protobuf-3.21.4
./configure
make -j$(<span style="font-weight: bold;">nproc</span>)
</pre>
</div>
<p>
ç„¶åæ‰“åŒ…
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo make <span style="font-weight: bold; font-style: italic;">DESTDIR</span>=/tmp/dest-protobuf install
<span style="font-weight: bold;">cd</span> /tmp
mksquashfs dest-protobuf/ tbt-protobuf-3.21.4.tcz
</pre>
</div>
<p>
å­˜å…¥SDå¡ä¸­å¹¶è®¾ç½®å¼€æœºè£…è½½
</p>
<div class="org-src-container">
<pre class="src src-bash">mv tbt-protobuf-3.21.4.tcz /mnt/mmcblk0p2/tce/optional/
<span style="font-weight: bold;">echo</span> <span style="font-style: italic;">'tbt-protobuf-3.21.4.tcz'</span> &gt;&gt; /mnt/mmcblk0p2/tce/onboot.lst
</pre>
</div>
</div>
</div>
<div id="outline-container-orge70a1f6" class="outline-3">
<h3 id="orge70a1f6"><span class="section-number-3">3.2.</span> <a href="#orge70a1f6">brotli</a></h3>
<div class="outline-text-3" id="text-3-2">
<p>
ä» <a href="https://github.com/google/brotli">repo</a> ä¸‹è½½ <a href="https://github.com/google/brotli/archive/refs/tags/v1.0.9.tar.gz"><code>brotli-1.0.9.tar.gz</code></a> ç¼–è¯‘æ‰“åŒ…
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="font-weight: bold;">cd</span> /tmp
tar xf brotli-1.0.9.tar.gz
<span style="font-weight: bold;">cd</span> brotli-1.0.9
mkdir out &amp;&amp; <span style="font-weight: bold;">cd</span> out
../configure-cmake              <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">&#20250;&#26377;&#20960;&#20010; warning, &#19981;&#29992;&#31649;
</span>make
sudo make <span style="font-weight: bold; font-style: italic;">DESTDIR</span>=/tmp/dest-brotli install
<span style="font-weight: bold;">cd</span> /tmp
mksquashfs dest-brotli/ tbt-brotli-1.0.9.tcz
mv tbt-brotli-1.0.9.tcz /mnt/mmcblk0p2/tce/optional/
<span style="font-weight: bold;">echo</span> <span style="font-style: italic;">'tbt-brotli-1.0.9.tcz'</span> &gt;&gt; /mnt/mmcblk0p2/tce/onboot.lst
</pre>
</div>
</div>
</div>
<div id="outline-container-org844e790" class="outline-3">
<h3 id="org844e790"><span class="section-number-3">3.3.</span> <a href="#org844e790">GoogleTest</a></h3>
<div class="outline-text-3" id="text-3-3">
<p>
ä» <a href="https://github.com/google/googletest">repo</a> ä¸‹è½½ <a href="https://github.com/google/googletest/archive/refs/tags/release-1.12.1.tar.gz"><code>googletest-release-1.12.1.tar.gz</code></a> , æ ¹æ® <a href="https://github.com/google/googletest/blob/main/googletest/README.md">README</a> ç¼–è¯‘æ‰“åŒ…
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="font-weight: bold;">cd</span> /tmp
tar xf googletest-release-1.12.1.tar.gz
<span style="font-weight: bold;">cd</span> googletest-release-1.12.1
mkdir build &amp;&amp; <span style="font-weight: bold;">cd</span> build
cmake ..
make
sudo make <span style="font-weight: bold; font-style: italic;">DESTDIR</span>=/tmp/dest-googletest install
<span style="font-weight: bold;">cd</span> /tmp
mksquashfs dest-googletest/ tbt-googletest-1.12.1.tcz
mv tbt-googletest-1.12.1.tcz /mnt/mmcblk0p2/tce/optional/
<span style="font-weight: bold;">echo</span> <span style="font-style: italic;">'tbt-googletest-1.12.1.tcz'</span> &gt;&gt; /mnt/mmcblk0p2/tce/onboot.lst
</pre>
</div>

<p>
ä¸‰ä¸ªä¾èµ–ç¼–è¯‘å¹¶å®‰è£…å®Œæˆå, æ‰‹åŠ¨ load è¿™ä¸‰ä¸ªåŒ…
</p>
<div class="org-src-container">
<pre class="src src-bash">tce-load -i <span style="font-style: italic;">\</span>
         tbt-protobuf-3.21.4.tcz <span style="font-style: italic;">\</span>
         tbt-brotli-1.0.9.tcz <span style="font-style: italic;">\</span>
         tbt-googletest-1.12.1.tcz
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf53fea4" class="outline-3">
<h3 id="orgf53fea4"><span class="section-number-3">3.4.</span> <a href="#orgf53fea4">Go</a></h3>
<div class="outline-text-3" id="text-3-4">
<p>
ä»<a href="https://go.dev/dl/">è¿™é‡Œ</a>ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„ Go è¯­è¨€å·¥å…·é“¾ (<a href="https://go.dev/dl/go1.19.linux-armv6l.tar.gz"><code>go1.19.linux-armv6l.tar.gz</code></a>).
ç”±äº Go ç¼–è¯‘å™¨åªæ˜¯å®‰è£…æ—¶éœ€è¦çš„ä¾èµ–, ä¸ç”¨æ‰“åŒ…, ç›´æ¥è§£å‹åˆ° <code>/usr/local</code>
å¹¶ä¿®æ”¹ <code>PATH</code> å³å¯.
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo tar -C /usr/local/ -xf go1.19.linux-armv6l.tar.gz
<span style="font-weight: bold;">export</span> <span style="font-weight: bold; font-style: italic;">PATH</span>=/usr/local/go/bin:$<span style="font-weight: bold; font-style: italic;">PATH</span>
</pre>
</div>

<p>
ä¹‹åç¼–è¯‘ adb æ—¶ä¼šç”¨åˆ° https ä»£ç†å’Œ CA è¯ä¹¦
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="font-weight: bold;">export</span> <span style="font-weight: bold; font-style: italic;">https_proxy</span>=<span style="font-style: italic;">'http://192.168.1.123:8889'</span>

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">this is needed for golang while building adb
</span><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">https://stackoverflow.com/a/67622500/11938767
</span><span style="font-weight: bold;">export</span> <span style="font-weight: bold; font-style: italic;">SSL_CERT_FILE</span>=/usr/local/etc/ssl/certs/ca-certificates.crt
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org1f513b1" class="outline-2">
<h2 id="org1f513b1"><span class="section-number-2">4.</span> <a href="#org1f513b1">ç¼–è¯‘ ADB</a></h2>
<div class="outline-text-2" id="text-4">
<p>
ä» <a href="https://github.com/nmeum/android-tools">repo</a> ä¸‹è½½ release <a href="https://github.com/nmeum/android-tools/releases/download/31.0.3p2/android-tools-31.0.3p2.tar.xz"><code>android-tools-31.0.3p2.tar.xz</code></a>
(ps. ä¸å¤§, åªæœ‰20M+, åƒä¸‡ä¸è¦å¸¦ç€ submodule clone, 5555&#x2026;)
</p>

<div class="org-src-container">
<pre class="src src-bash">tar xf android-tools-31.0.3p2.tar.xz
<span style="font-weight: bold;">cd</span> android-tools-31.0.3p2
mkdir build &amp;&amp; <span style="font-weight: bold;">cd</span> build
cmake ..
make
sudo make <span style="font-weight: bold; font-style: italic;">DESTDIR</span>=/tmp/dest-android-tools install
<span style="font-weight: bold;">cd</span> /tmp
mksquashfs dest-android-tools/ tbt-android-tools-31.0.3p2.tcz
<span style="font-weight: bold;">echo</span> <span style="font-style: italic;">'tbt-android-tools-31.0.3p2.tcz'</span> &gt;&gt; /mnt/mmcblk0p2/tce/onboot.lst
tce-load -i tbt-android-tools-31.0.3p2.tcz
</pre>
</div>

<p>
ç„¶åè¿è¡Œ <code>adb</code>, æ²¡é”™è¯¯å°±ä»£è¡¨æˆåŠŸå•¦~
</p>

<p>
åœ¨ç¼–è¯‘æ—¶, Go åœ¨ home ç›®å½•ä¸‹ä¼šå»ºä¸€ä¸ªæ–‡ä»¶å¤¹ <code>go</code>, å¯ä»¥ç›´æ¥åˆ äº†
</p>
<div class="org-src-container">
<pre class="src src-bash">rm -rf ~/go
</pre>
</div>

<p>
æœ€åä¸€å®šè¦è®°å¾—å¤‡ä»½ä¸€ä¸‹æ–‡ä»¶ (è™½ç„¶å…¶å®ä¹Ÿæ²¡å•¥è¦å¤‡ä»½çš„)
</p>
<div class="org-src-container">
<pre class="src src-bash">filetool.sh -b
</pre>
</div>

<p>
æœ€åçš„æœ€å, å¯ä»¥å¤‡ä»½ä¸€ä¸‹ <code>/mnt/mmcblk0p2/tce</code>.
</p>

<p>
æ­¤æ—¶å°±å¯ä»¥æ”¾åˆ°æ ‘è“æ´¾3ä¸Šè·‘äº†, å‰©ä¸‹çš„ä¹Ÿå¯ä»¥ç›´æ¥åœ¨3ä¸Šé…ç½®.
</p>
</div>
</div>
<div id="outline-container-org8d10029" class="outline-2">
<h2 id="org8d10029"><span class="section-number-2">5.</span> <a href="#org8d10029">å†…ç½‘ç©¿é€</a></h2>
<div class="outline-text-2" id="text-5">
<p>
ä¸ºäº†è¿œç¨‹è®¿é—®æ–¹ä¾¿, åŠ ä¸€ä¸ª frp çš„åŒ….
</p>

<p>
ä¸‹è½½ <a href="https://github.com/fatedier/frp/releases/download/v0.44.0/frp_0.44.0_linux_arm.tar.gz"><code>frp_0.44.0_linux_arm.tar.gz</code></a> åˆ° <code>/tmp</code> ä¸‹, è§£å‹, åˆ¶ä½œåŒ…
</p>
<div class="org-src-container">
<pre class="src src-bash">tar xf frp_0.44.0_linux_arm.tar.gz
mkdir -vp dest-frp/usr/local/{bin,etc/frp}
mv frp_0.44.0_linux_arm/frp{c,s} dest-frp/usr/local/bin/
mv frp_0.44.0_linux_arm/frp*.ini dest-frp/usr/local/etc/frp/

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">&#36825;&#37324;&#21487;&#20197;&#25913;&#19968;&#19979;&#37197;&#32622;
</span>cat &lt;&lt;ConfigEndsHERE &gt; dest-frp/usr/local/etc/frp/frpc.ini<span style="font-weight: bold;">
[common]
server_addr = 127.0.0.1
server_port = 7000

[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = 6000
ConfigEndsHERE
</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">&#37117;&#25913;&#20026; root
</span>sudo chown -R root: dest-frp

mksquashfs dest-frp/ tbt-frp-0.44.0.tcz
mv tbt-frp-0.44.0.tcz /mnt/mmcblk0p2/tce/optional/
<span style="font-weight: bold;">echo</span> <span style="font-style: italic;">'tbt-frp-0.44.0.tcz'</span> &gt;&gt; /mnt/mmcblk0p2/tce/onboot.lst
</pre>
</div>
<p>
ç›®å½•ç»“æ„å¦‚ä¸‹
</p>
<div class="org-src-container">
<pre class="src src-text">dest-frp
&#9492;&#9472;&#9472; usr
    &#9492;&#9472;&#9472; local
        &#9500;&#9472;&#9472; bin
        &#9474;&#160;&#160; &#9500;&#9472;&#9472; frpc
        &#9474;&#160;&#160; &#9492;&#9472;&#9472; frps
        &#9492;&#9472;&#9472; etc
            &#9492;&#9472;&#9472; frp
                &#9500;&#9472;&#9472; frpc_full.ini
                &#9500;&#9472;&#9472; frpc.ini
                &#9500;&#9472;&#9472; frps_full.ini
                &#9492;&#9472;&#9472; frps.ini
</pre>
</div>

<p>
æœ€å, æŠŠ <code>frpc</code> çš„å¼€æœºè„šæœ¬æ”¾åˆ° <code>/opt/bootlocal.sh</code> ä¸­
(ps. <code>/opt</code> ä¸‹æœ‰ä¸¤ä¸ªå¼€æœºè„šæœ¬: <code>bootlocal.sh</code> å’Œ <code>bootsync.sh</code>,
åè€…ä¼šæŠŠå‰è€…æ”¾åˆ°åå°è¿è¡Œ, ä»¥å…é˜»å¡å¼€æœºè¿›ç¨‹)
</p>
<div class="org-src-container">
<pre class="src src-bash">cat &lt;&lt;<span style="font-style: italic;">'CmdEndsHERE'</span> &gt;&gt; /opt/bootlocal.sh<span style="font-weight: bold;">
# wait for network and then start frpc
# for loop from https://stackoverflow.com/a/24897831/11938767
i=1
while [ $i -le 20 ]; do
  sleep 1
  touch /tmp/waiting-${i}s
  i=$(</span><span style="font-weight: bold;">expr $i + 1</span><span style="font-weight: bold;">)
  if pidof udhcpc &gt; /dev/null; then
    /usr/local/bin/frpc -c /usr/local/etc/frp/frpc.ini &gt;/tmp/frpc.log 2&gt;&amp;1 &amp;
    break
  fi
done
CmdEndsHERE</span>
</pre>
</div>
<p>
æ ¹æ® <code>/etc/init.d/dhcp.sh</code>, åœ¨æ‰§è¡Œ <code>frpc</code> ä¹‹å‰ DHCP å¯èƒ½è¿˜æ²¡å¯åŠ¨,
æ‰€ä»¥éœ€è¦æµ‹è¯• DHCP æ˜¯å¦å¯åŠ¨.  ç”± <code>/etc/init.d/services/dhcp</code>,
å¯ä»¥ä½¿ç”¨ <code>pidof udhcpc</code> æµ‹è¯• DHCP çŠ¶æ€.
</p>

<p>
å†æ¬¡å¤‡ä»½, é‡å¯, å°±å¯ä»¥ç›´æ¥é€šè¿‡ frp è®¿é—®æ ‘è“æ´¾å•¦~
</p>
<div class="org-src-container">
<pre class="src src-bash">filetool.sh -b
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcc0f199" class="outline-2">
<h2 id="orgcc0f199"><span class="section-number-2">6.</span> <a href="#orgcc0f199">å°ç»“</a></h2>
<div class="outline-text-2" id="text-6">
<p>
æ„Ÿè§‰ç”¨ piCore å†è‡ªå·±ç¼–è¯‘æ‰“åŒ…å„ç§ä¸œè¥¿ç€å®æœ‰ç‚¹éº»çƒ¦äº†,
å¯èƒ½ç›´æ¥æŠŠ Raspberry Pi OS é…ç½®å¥½å†åœ¨ <code>raspi-config</code> é‡Œè®¾ç½®æˆ SD å¡åªè¯»ä¼šæ›´ç®€å•ä¹Ÿæ›´é è°±ä¸€ç‚¹.  ä¸è¿‡è¿˜æ˜¯æŒºæœ‰æ„æ€çš„,
è€Œä¸”ä¹Ÿå­¦åˆ°äº†ä¸€äº›ä¸œè¥¿, ç®—æ˜¯æŠŠä¹‹å‰ LFS çš„ç¼–è¯‘å‘½ä»¤ç”¨äº†ä¸‹.
</p>

<p>
ç”±äºè‡ªå·±ç¼–è¯‘çš„å‡ ä¸ªåŒ…éƒ½æ˜¯å¼€æœºç›´æ¥ load çš„, å¯èƒ½å¯¼è‡´å¼€æœºé€Ÿåº¦æ…¢äº†ä¸å°‘.
å®æµ‹ä»ä¸Šç”µåˆ° frp è¿æ¥æˆåŠŸéœ€è¦å¤§çº¦ 25s, reboot åˆ™éœ€è¦ 34s å·¦å³.
</p>

<p>
ç„¶åå¦‚æœè¿è¡ŒæœŸé—´ frp æ–­æ‰æˆ–è€…å‡ºå…¶ä»–ä»€ä¹ˆçŠ¶å†µçš„è¯æ˜¯æ— è§£çš„, åªèƒ½é‡å¯.
å‡†å¤‡ä¹°ä¸€ä¸ªç±³å®¶çš„æ™ºèƒ½å¼€å…³, å‡ºé—®é¢˜å°±ç›´æ¥è¿œç¨‹æ–­ç”µé‡å¼€.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr><table class="postamble">
  <tr><td class="org-right">Author</td><td class="org-left">thebesttv</td></tr>
  <tr><td class="org-right">Created</td><td class="org-left">2022-08-09 23:51</td></tr>
  <tr><td class="org-right">Modified</td><td class="org-left">2022-12-05 22:13</td></tr>
  <tr><td class="org-right">Generated</td><td class="org-left">2025-10-28 02:51</td></tr>
  <tr><td class="org-right">Version</td><td class="org-left"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 30.2 (<a href="https://orgmode.org">Org</a> mode 9.7.11)</td></tr>
  <tr><td class="org-right">Raw</td><td class="org-left"><a href="https://raw.githubusercontent.com/thebesttv/thebesttv.github.io/main/content/picore-adb.org">picore-adb.org</a></td></tr>
</table>
</div>
</body>
</html>
